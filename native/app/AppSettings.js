APP={Fields:[],User:{},Entities:[],Menu:[]};AJAX_URL="";AJAX_HANDLER="";function GetTemplate(c,a){var b;if(c=="boat"){b='<div class="item" style="'+(a.signondate?"background-color:#008A2E":"")+'"><div class="name">'+Ext.String.ellipsis(a.bname,20)+'</div><div class="vicinity">'+a.hullnumber+"</div></div>"}else{if(c=="myboat"){b='<div class="item" style="'+(a.signondate?"background-color:#008A2E":"")+'"><div class="name">'+Ext.String.ellipsis(a.name,50)+'</div><div class="vicinity">'+a.hullnumber+"</div></div>"}else{if(c=="boattime"){b='<div class="item" style="'+(a.signondate?"background-color:#008A2E":"")+'"><div class="name">'+Ext.String.ellipsis(a.bname,20)+'</div><div class="vicinity">'+a.hullnumber+" | <b>"+a.endtime.split(" ")+" </b></div></div>"}else{if(c=="menu"){b='<div class="menuItem" style="background-color:lightgray"><br/><br/><img src="http://bystorm.com.au/DM/common/'+(a.mobiletemplate?a.mobiletemplate:"star.png")+'" width="80px" height="80"/><br/><br/><div class="name">'+Ext.String.ellipsis(a.name,20)+"</div></div>"}else{if(c=="raceboat"){b='<div class="item" style="'+(a.signondate?"background-color:#008A2E":"")+'"><div class="name">'+Ext.String.ellipsis(a.bname,20)+'</div><div class="vicinity">'+Ext.String.ellipsis(a.rname,25)+'</div><div class="vicinity">'+a.hullnumber+'</div><div class="vicinity">'+(a.skippername?a.skippername:" - ")+"</div></div>"}else{if(c=="race"){b='<div class="item"><div class="name">'+a.name+'</div><div class="vicinity">Start time: '+a.startdate+"</div></div>"}else{if(c=="boatresult"){b='<div class="item" style="'+(a.signondate?"background-color:#008A2E":"")+'"><div class="name">'+a.hullnumber+"<br/>"+Ext.String.ellipsis(a.bname,20)+'</div><div class="vicinity">Time: '+(a.endtime?a.endtime:"")+' </b></div><div class="vicinity">Handicap: '+(a.handicap?a.handicap:"")+" </div></div>"}}}}}}}return b}function BoatFilter(b){var a=this.getValue().toLowerCase();return b.get("bname").toLowerCase().indexOf(a)>-1||b.get("hullnumber").toLowerCase().indexOf(a)>-1}function IsNull(b,a){return b?b:a}function GetEntityView(a){var c=APP.Menu;for(var b=0;b<c.length;b++){if(c[b].entityid==a){return c[b]}}return""}function GetDisplayField(a){for(var b=0;b<a.length;b++){if(a[b]._name.indexOf("id")==-1){return a[b]._name}}return""}function CreateModel(e,c){var a=["sysrowstate"],b="";if(!Ext.ModelManager.isRegistered(e)){for(var d=0;d<APP.Fields.length;d++){var f=APP.Fields[d];if(f.entityid==c){a.push({name:f.name});if(f.iseditable=="1"){b+=(b?",":"")+f.name}}}Ext.define(e,{extend:"Ext.data.Model",requires:[],config:{fields:a,entityFields:b},entityFields:b})}return a}function GetEntityView(a){var c=APP.Menu;for(var b=0;b<c.length;b++){if(c[b].entityid==a){return c[b]}}return""}function GetEntityByName(a){for(i=0;i<APP.Entities.length;i++){rec=APP.Entities[i];if(rec.name==a){return rec}}return null}function CreateStore(c){var a=GetEntityByName(c),d=localStorage.goOffline,e="SQL",b=d?"DynaMightMobile.model."+a.name+e:"DynaMightMobile.model."+a.name;CreateModel(b,a.entityid);store=new Ext.data.Store({model:b});return store}function GetFieldsByEntity(b){var e,d,c,a="";for(c=0;c<APP.Fields.length;c++){e=APP.Fields[c];if(e.entityid!=b||e.isonlyview=="1"){continue}a+=(a?",":"")+e.name}return a}function GetEntityViewByName(a){var c=APP.Menu;for(var b=0;b<c.length;b++){if(c[b].name==a){return c[b]}}return""}function AJAXCommand(a){if(localStorage.goOffline){Ext.Msg.alert("Ooops","You are working offline. Action could not be completed!");return}var b={object:a.object||"Business",method:a.method,params:a.params,security:{userID:0}};var c=Ext.JSON.encode(b);Ext.Ajax.request({url:AJAX_URL+AJAX_HANDLER,method:"POST",params:{command:c},scope:a.scope?a.scope:null,success:function(d){var e=Ext.decode(d.responseText);if(e.success){if(a.callback){a.callback(true,e.message,e,a.scope)}}else{this.onFailure(d)}},failure:this.onFailure,timeout:60000,onFailure:function(e,d){Ext.Msg.show({title:T("Application errorr"),msg:T("Application error!"),buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR,modal:true})},onSuccess:function(){}})}function replaceHTMLSpCharacters(a){if(a!==null){a=a.replace(/\\/g,"\\\\");a=a.replace(/\r/g,"\\r");a=a.replace(/"/g,'\\"')}return a};